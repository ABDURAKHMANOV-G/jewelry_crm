{% extends 'base.html' %}

{% block title %}Формирование отчёта - JEWEllUX{% endblock %}

{% block content %}
<section class="report-form-section">
    <div class="report-form-container">
        <div class="report-form-card">
            <!-- HEADER -->
            <div class="report-form-header">
                <h1 class="report-form-title">
                    <i class="bi bi-bar-chart-line"></i>
                    Формирование отчёта
                </h1>
            </div>
            
            <!-- BODY -->
            <div class="report-form-body">
                <p class="report-form-description">
                    Выберите период и создайте подробный отчёт о деятельности компании ООО «JEWEllUX»
                </p>
                
                <form method="GET" action="{% url 'report_generate' %}">
                    <div class="report-form-group">
                        <label for="start_date" class="report-form-label">
                            <i class="bi bi-calendar-event"></i>
                            Начало периода
                        </label>
                        <input type="date" 
                               class="report-date-input" 
                               id="start_date" 
                               name="start_date" 
                               required>
                    </div>
                    
                    <div class="report-form-group">
                        <label for="end_date" class="report-form-label">
                            <i class="bi bi-calendar-check"></i>
                            Конец периода
                        </label>
                        <input type="date" 
                               class="report-date-input" 
                               id="end_date" 
                               name="end_date" 
                               required>
                    </div>
                    
                    <div class="report-form-actions">
                        <button type="submit" class="btn-report-submit">
                            <i class="bi bi-search"></i>
                            Просмотреть отчёт
                        </button>
                        <a href="{% url 'order_list' %}" class="btn-report-cancel">
                            Отмена
                        </a>
                    </div>
                </form>
                
                <!-- QUICK PERIODS -->
                <div class="report-quick-periods">
                    <p class="report-quick-title">Быстрый выбор периода:</p>
                    
                    <div class="report-quick-buttons">
                        <form method="GET" action="{% url 'report_generate' %}">
                            <input type="hidden" name="start_date" id="quick_start_today">
                            <input type="hidden" name="end_date" id="quick_end_today">
                            <button type="submit" class="btn-quick-period">
                                <i class="bi bi-calendar-day"></i> Сегодня
                            </button>
                        </form>
                        
                        <form method="GET" action="{% url 'report_generate' %}">
                            <input type="hidden" name="start_date" id="quick_start_week">
                            <input type="hidden" name="end_date" id="quick_end_week">
                            <button type="submit" class="btn-quick-period">
                                <i class="bi bi-calendar-week"></i> На этой неделе
                            </button>
                        </form>
                        
                        <form method="GET" action="{% url 'report_generate' %}">
                            <input type="hidden" name="start_date" id="quick_start_month">
                            <input type="hidden" name="end_date" id="quick_end_month">
                            <button type="submit" class="btn-quick-period">
                                <i class="bi bi-calendar-month"></i> В этом месяце
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    function formatDate(date) {
        return date.toISOString().split('T')[0];
    }
    
    const today = new Date();
    
    // Сегодня
    document.getElementById('quick_start_today').value = formatDate(today);
    document.getElementById('quick_end_today').value = formatDate(today);
    
    // На этой неделе
    const currentDay = today.getDay();
    const monday = new Date(today);
    monday.setDate(today.getDate() - (currentDay === 0 ? 6 : currentDay - 1));
    document.getElementById('quick_start_week').value = formatDate(monday);
    document.getElementById('quick_end_week').value = formatDate(today);
    
    // В этом месяце
    const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
    document.getElementById('quick_start_month').value = formatDate(firstDay);
    document.getElementById('quick_end_month').value = formatDate(today);
});
</script>
{% endblock %}
