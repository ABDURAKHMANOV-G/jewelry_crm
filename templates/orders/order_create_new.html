{% extends 'base.html' %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ - JEWEllUX{% endblock %}

{% block content %}
<section class="create-order-section">
    <div class="container-create">
        
        <!-- HEADER -->
        <div class="create-header">
            <a href="{% url 'order_list' %}" class="btn-back">
                <i class="bi bi-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ –∑–∞–∫–∞–∑–∞–º
            </a>
            <h1 class="create-title">
                <i class="bi bi-plus-circle"></i>
                –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
            </h1>
        </div>

        <!-- –§–û–†–ú–ê -->
        <div class="create-form-wrapper">
            <form method="POST" enctype="multipart/form-data" class="create-form" id="orderForm">
                {% csrf_token %}
                
                <!-- –°–ï–ö–¶–ò–Ø 1: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="form-section">
                    <h2 class="form-section-title">
                        <i class="bi bi-info-circle"></i>
                        –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_product_type">–¢–∏–ø –∏–∑–¥–µ–ª–∏—è *</label>
                            {{ form.product_type }}
                            {% if form.product_type.errors %}
                            <span class="form-error">{{ form.product_type.errors|first }}</span>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label for="id_order_type">–¢–∏–ø –∑–∞–∫–∞–∑–∞ *</label>
                            <select id="id_order_type" name="order_type" class="form-control" onchange="toggleOrderType()">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∑–∞–∫–∞–∑–∞</option>
                                <option value="template">üìã –®–∞–±–ª–æ–Ω–Ω—ã–π</option>
                                <option value="custom">‚úèÔ∏è –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π</option>
                            </select>
                            {% if form.order_type.errors %}
                            <span class="form-error">{{ form.order_type.errors|first }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- –°–ï–ö–¶–ò–Ø 2: –®–ê–ë–õ–û–ù–ù–´–ô –ó–ê–ö–ê–ó -->
                <div id="templateSection" class="form-section" style="display: none;">
                    <h2 class="form-section-title">
                        <i class="bi bi-bookmark"></i>
                        –í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_template_image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞</label>
                            {{ form.template_image }}
                            {% if form.template_image.errors %}
                            <span class="form-error">{{ form.template_image.errors|first }}</span>
                            {% endif %}
                        </div>
                        
                        <div class="form-group" id="templateRingSizeGroup" style="display: none;">
                            <label for="id_ring_size">–†–∞–∑–º–µ—Ä –∫–æ–ª—å—Ü–∞</label>
                            {{ form.ring_size }}
                            <small class="form-hint">–¢–æ–ª—å–∫–æ –¥–ª—è –∫–æ–ª–µ—Ü</small>
                        </div>
                    </div>
                </div>

                <!-- –°–ï–ö–¶–ò–Ø 3: –ò–ù–î–ò–í–ò–î–£–ê–õ–¨–ù–´–ô –ó–ê–ö–ê–ó -->
                <div id="customSection" class="form-section" style="display: none;">
                    <h2 class="form-section-title">
                        <i class="bi bi-sliders"></i>
                        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑–¥–µ–ª–∏—è
                    </h2>
                    
                    <div class="form-row form-row-4">
                        <div class="form-group">
                            <label for="id_ring_size">–†–∞–∑–º–µ—Ä</label>
                            {{ form.ring_size }}
                        </div>
                        
                        <div class="form-group">
                            <label for="id_thickness">–¢–æ–ª—â–∏–Ω–∞ (–º–º)</label>
                            {{ form.thickness }}
                        </div>
                        
                        <div class="form-group">
                            <label for="id_width">–®–∏—Ä–∏–Ω–∞ (–º–º)</label>
                            {{ form.width }}
                        </div>
                        
                        <div class="form-group">
                            <label for="id_stone_size">–†–∞–∑–º–µ—Ä –∫–∞–º–Ω—è (–∫–∞—Ä–∞—Ç)</label>
                            {{ form.stone_size }}
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="id_desired_weight">–ñ–µ–ª–∞–µ–º—ã–π –≤–µ—Å (–≥)</label>
                        {{ form.desired_weight }}
                    </div>
                </div>

                <!-- –°–ï–ö–¶–ò–Ø 4: –ú–ê–¢–ï–†–ò–ê–õ –ò –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô -->
                <div class="form-section">
                    <h2 class="form-section-title">
                        <i class="bi bi-palette"></i>
                        –ú–∞—Ç–µ—Ä–∏–∞–ª –∏ –¥–µ—Ç–∞–ª–∏
                    </h2>
                    
                    <div class="form-group">
                        <label for="id_material">–ú–∞—Ç–µ—Ä–∏–∞–ª *</label>
                        {{ form.material }}
                        {% if form.material.errors %}
                        <span class="form-error">{{ form.material.errors|first }}</span>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="id_comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ –æ—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è</label>
                        {{ form.comment }}
                        <small class="form-hint">–û–ø–∏—à–∏—Ç–µ –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–∑–¥–µ–ª–∏—é</small>
                    </div>
                </div>

                <!-- –°–ï–ö–¶–ò–Ø 5: –§–ò–ù–ê–ù–°–´ –ò –°–†–û–ö–ò -->
                <div class="form-section">
                    <h2 class="form-section-title">
                        <i class="bi bi-calendar3-event"></i>
                        –§–∏–Ω–∞–Ω—Å—ã –∏ —Å—Ä–æ–∫–∏
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_budget">–ë—é–¥–∂–µ—Ç (‚ÇΩ) *</label>
                            {{ form.budget }}
                            {% if form.budget.errors %}
                            <span class="form-error">{{ form.budget.errors|first }}</span>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label for="id_required_by">–ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ *</label>
                            {{ form.required_by }}
                            {% if form.required_by.errors %}
                            <span class="form-error">{{ form.required_by.errors|first }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô -->
                <div class="form-actions">
                    <a href="{% url 'order_list' %}" class="btn-cancel">
                        <i class="bi bi-x-circle"></i> –û—Ç–º–µ–Ω–∞
                    </a>
                    <button type="submit" class="btn-gold btn-submit">
                        <i class="bi bi-check-circle"></i> –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
                    </button>
                </div>
            </form>

            <!-- –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ô –ë–õ–û–ö -->
            <div class="create-info-box">
                <h3 class="info-box-title">
                    <i class="bi bi-lightbulb"></i>
                    –°–æ–≤–µ—Ç—ã –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∑–∞–∫–∞–∑–∞
                </h3>
                <ul class="info-list">
                    <li><strong>–®–∞–±–ª–æ–Ω–Ω—ã–π –∑–∞–∫–∞–∑:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π –¥–∏–∑–∞–π–Ω –∏–∑ –Ω–∞—à–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏</li>
                    <li><strong>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:</strong> –£–∫–∞–∂–∏—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–∑–¥–µ–ª–∏—è</li>
                    <li><strong>–ú–∞—Ç–µ—Ä–∏–∞–ª:</strong> –í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥</li>
                    <li><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> –î–æ–±–∞–≤—å—Ç–µ –¥–µ—Ç–∞–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω—ã –¥–ª—è –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞</li>
                    <li><strong>–î–∞—Ç–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:</strong> –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –¥–∞—Ç—É, —á—Ç–æ–±—ã —é–≤–µ–ª–∏—Ä –º–æ–≥ —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É</li>
                </ul>
            </div>
        </div>

    </div>
</section>

<script>
function toggleOrderType() {
    const orderType = document.getElementById('id_order_type').value;
    const templateSection = document.getElementById('templateSection');
    const customSection = document.getElementById('customSection');
    const productType = document.getElementById('id_product_type').value;
    const templateRingSizeGroup = document.getElementById('templateRingSizeGroup');
    
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    templateSection.style.display = 'none';
    customSection.style.display = 'none';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å–µ–∫—Ü–∏—é
    if (orderType === 'template') {
        templateSection.style.display = 'block';
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–æ–ª—å—Ü–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ –∫–æ–ª—å—Ü–æ
        if (productType === 'ring') {
            templateRingSizeGroup.style.display = 'block';
        }
    } else if (orderType === 'custom') {
        customSection.style.display = 'block';
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–∏–ø–∞ –∏–∑–¥–µ–ª–∏—è
document.addEventListener('DOMContentLoaded', function() {
    const productTypeSelect = document.getElementById('id_product_type');
    if (productTypeSelect) {
        productTypeSelect.addEventListener('change', toggleOrderType);
    }
});
</script>
{% endblock %}
