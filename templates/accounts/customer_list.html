{% extends 'base.html' %}
{% load phone_filters %}

{% block title %}–°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>üë• –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
    <span class="badge bg-primary" style="font-size: 1rem;">–í—Å–µ–≥–æ: {{ customers|length }}</span>
</div>

<!-- –§–ò–õ–¨–¢–†–ê–¶–ò–Ø -->
<div class="card mb-4">
    <div class="card-body">
        <form method="GET" class="row g-3">
            <div class="col-md-10">
                <input type="text" 
                       name="search" 
                       class="form-control" 
                       placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, email, —Ç–µ–ª–µ—Ñ–æ–Ω—É..." 
                       value="{{ search }}">
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">–ù–∞–π—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<!-- –°–ü–ò–°–û–ö –ö–õ–ò–ï–ù–¢–û–í -->
{% if customers %}
<div class="row">
    {% for customer in customers %}
    <div class="col-md-6 mb-4">
        <div class="card shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="card-title mb-0">
                        {{ customer.name }} {{ customer.surname }}
                    </h5>
                    <span class="badge bg-info">{{ customer.orders_count }} –∑–∞–∫–∞–∑(–æ–≤)</span>
                </div>
                
                <p class="mb-2">
                    <i class="bi bi-telephone"></i> 
                    <strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ customer.phone|format_phone }}
                </p>
                
                <p class="mb-3">
                    <i class="bi bi-envelope"></i> 
                    <strong>Email:</strong> {{ customer.email|default:"‚Äî" }}
                </p>
                
                <a href="{% url 'customer_orders' customer.customer_id %}" 
                   class="btn btn-primary w-100">
                    üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑—ã
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info text-center">
    <h4>–ö–ª–∏–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
</div>
{% endif %}
{% endblock %}
